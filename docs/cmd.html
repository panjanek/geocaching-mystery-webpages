<html>
  <head>
    <style>
	.center {
		  margin: auto;
		  width: min-content;
		  border: 1px solid gray;
		  padding: 10px;
	}
	
	.footer {
		position: fixed; 
		bottom: 0;
		left: 0;
		right: 0;
		height: 50px;
		background: white
	}
	</style>
  </head>
  <body style="height: 100%;">
    <div style="width: min-content;margin: auto;font-family: Courier;padding: 10px;">
      <p>Użyj&nbspklawiatury&nbsp/&nbspUse&nbspkeyboard</p>
	</div>  
    <div class="center">
      <canvas  id="c" width="800" height="480"></canvas>
	</div>
    <div style="width: min-content;margin: auto;font-family: Courier;padding: 10px;">
      <input type="text" id="mobile" placeholder="tap here on mobile" style="border: 0;"/>
	</div>
	<div class="footer">
	  <div style="width: min-content;margin: auto;font-family: Courier"><strong>Czarne&nbspOkienko</strong>&nbspby&nbspPanJanek123</div>
	</div>
	<script>
const questions = [ 
  {
	  "pl" : "Zeszyt kosztuje o 100 więcej niż ołówek. Razem kosztują 110. Ile kosztuje zeszyt?",
	  "en" : "Notebook costs 100 more than pencil. Together they cost 110. How much is the notebook?"
  },
  {
	  "pl" : "15 maszyn produkuje 15 zabawek w 15 minut. Ile minut potrzeba aby 150 maszyn wyprodukowało 150 zabawek?",
	  "en" : "15 machines produce 15 toys in 15 minutes. How many minutes it takes for 150 machines to produce 150 toys?"
  },
  {
	  "pl" : "Lilia zarasta jezioro w ten sposób, że każdego dnia pokrywa dwukrotnie większą jego powierzchnię. Po 48 dniach całe jezioro jest zarośnięte. Po ilu dniach jest zarośnięte w połowie?",
	  "en" : "Lily grows in a lake in a way that each day doubles the surface. After 48 days entire lake in covered. After how many days half the lake is covered?"
  },
  {
	  "pl" : "Masz 50 jedynek. Możesz je dowolnie dodawać, mnożyć i wstawiać nawiasy. Jaka jest największa liczba jaką możesz dostać?(podpowiedzi: AI, 8 cyfr)",
	  "en" : "You have 50 ones. You can add, multiply and add brackets in any way you want. What is the biggest number you can get? (hints: AI, 8 digits)"
  },  
  {
	  "pl" : "Hipoteza Goldbacha mówi, że każdą liczbę parzystą da się przedstawić jako sumę dwóch liczb pierwszych.\n Okazuje się, że większość liczb parzystych da się przedstawić jako sumę dwóch liczb pierwszych na wiele sposobów. Np. 10 da się przedstawić na dwa sposoby: 7+3 i 5+5. Na ile sposobów da się przedstawić 1000?",
	  "en" : "Goldbach conjectrue says that each even number can be expresses as sum of two primes. It turns out that most even numbers can be expressed as a sum of two primes in more than one way. For example 10 can be expressed in two ways: 7+3 and 5+5. In how many ways it is possible to express 1000?"
  }, 
  {
	  "pl" : "Według pewnej powieści komediowo-SF: Jak brzmi ostateczna odpowiedź na pytanie o Życie, Wszechświat i Całą Resztę?",
	  "en" : "According to some comedy-SF novel: What is the answet to the final question about Live, The Universe and Everything?"
  },    
  {
	  "pl" : "Biegniesz z prędkością 10km/h trasę o długości 10km: 5km tam i 5km spowrotem. Równo z Tobą startuje szybki biegacz który biegnie 2x szybciej i powolny który biegnie 2x wolniej. Po drodze mija Ciebie szybki biegacz, a potem Ty mijasz powolnego. Ile minut mija pomiędzy tymi spotkaniami?",
	  "en" : "You run 10km route: 5km there and 5km back. With you start a fast runner that runs 2x your speed and a slow runner that runs half your speed. During the run the fast runner pass you by and then you pass by the slow runner. How many minutes passes between this meeting?"
  },
  {
	  "pl" : "Kwadrat jest ograniczony czterema odcinkami. Szcześcian jest ograniczony 6cioma ścianami. Iloma figurami jest ograniczona 10-wymiarowa hiperkostka?",
	  "en" : "Square is constrained by four lines. Cube is constrained by 6 faces. How many shapes constrain 10-dimensional hypercube?"
  },
  {
	  "pl" : "Samolot leci wzdłuż 45 równoleżnika. Jaką musi mieć prędkość (w km/h) aby pozostawała na nim ta sama godzina? (promień ziemi = 6371km, ignorujemy wysokość lotu, zakładamy, że Ziemia jest idealną kulą, odpowiedź należy zaokrąglić do najbliższej liczby całkowitej)",
	  "en" : "A plane flies along 45th circle of lattitude. What is the speed of the plane (in km/h) if the local time onboard stays the same? (Earth radius = 6371km, ignore plane altitude, assume Earth is a perfect sphere, round aswer to nearest whole number)"
  },
  {
	  "pl" : "Ile liczb pierwszych znajduje się pomiędzy liczbami będącymi odpowiedziami na pytania 4te i 9te?",
	  "en" : "How many prime there is between the numbers being answers for questions 4th and 9th?"
  },    
];

const nextMsgs = 
[
  {
	  "pl" : "Ok. Zobaczymy...",
	  "en" : "Ok. We'll see..."
  },
  {
	  "pl" : "Może i dobrze...",
	  "en" : "This may by right..."
  },
  {
	  "pl" : "Napewno? Zobaczymy.",
	  "en" : "You sure? We'll see."
  },
  {
	  "pl" : "Ok. Może.",
	  "en" : "Ok. Maybe."
  },  
  {
	  "pl" : "Wygląda dobrze.",
	  "en" : "Seems right."
  },  
  {
	  "pl" : "Może być.",
	  "en" : "Could be."
  },  
];

const folders = 
{
    name: "C:",
	access: true,
	dir:true,
    content: 
	[
		{name: "DOS", access: false, dir:true},
		{name: "GAMES", access: true, dir:true, content: 
		  [
			{name: "GEOCACHE", access: true, dir:true, content: 
			  [
				{name: "QUIZ", access: true, dir:true, content:
				  [
					{name: "QUIZ.DAT", access: true, dir:false },
					{name: "QUIZ.EXE", access: true, dir:false },
					{name: "INFO.TXT", access: true, dir:false }
				  ]}
			  ]},
			{name: "SNAKE", access: true, dir:true, content:
			  [
					{name: "SNAKE.DAT", access: true, dir:false },
					{name: "SNAKE.EXE", access: true, dir:false },
					{name: "SNAKE.TXT", access: true, dir:false }		  
			  ]}		  
		  ]},
		  {name: "AUTOEXEC.BAT", access: false, dir:false},
		  {name: "CONFIG.SYS", access: false, dir:false},
    ]
};

var curPath = [folders];
var dosCommands = ["MD", "COPY", "RD", "DEL", "REN"];

const gc = [0	,2093056	,6323712	,8392576	,16778176	,33816800	,67502192	,134611000	,134610968	,268566536	,268566556	,268503032	,268517368	,805421064	,807305228	,
            821084172	,870334476	,864051212	,268460044	,268460044	,134225944	,134230040	,67121176	,33554480	,58720352	,12583104	,7340416	,925440	,122880	,0	 ];
	
	    var curX = 0;
		var curY = 0;
		var curColor = "white";
		var cursorVisible = true;		
	    const canvas = document.getElementById("c");
		const mobileInput = document.getElementById("mobile");
	    const ctx = canvas.getContext("2d");
		ctx.textBaseline = "top";
		ctx.textAlign = "left";
		ctx.font = "16px Courier New";
		const charWidth = 10;
		const charHeight = 16;
		var w = canvas.width;
		var h = canvas.height;
		var coursorInterval;
		var readMode = false;
		var readCallback;
		var readString = "";
		var easterEggTimeout;	
		
		const keySalt = '8bf32485128d4706bad955467948d7b0';
		const expectedMD5 = '8EED2A4EF08D8FCD690D6E8E4D14675D';
		const encryptedSolution = 'F1DCA4E59012267E33BC01922A63FAE82A9E8500E27EB244EC7A7126A65E212C596DE803041EF1BE1E5470DEB0';
		const easterEggPwd = ":)";
		
		const b64binb = base64String => Uint8Array.from(atob(base64String), c => c.charCodeAt(0));
		const str2binb = str => new TextEncoder().encode(str);
		const buf2hex = buffer => Array.prototype.map.call(new Uint8Array(buffer), x => ('00' + x.toString(16)).slice(-2)).join('');
		const fromHex = hexString => new Uint8Array(hexString.match(/.{1,2}/g).map(byte => parseInt(byte, 16)));
		const fromBase64 = base64String => Uint8Array.from(atob(base64String), c => c.charCodeAt(0));
		var MD5 = function(d){var r = M(V(Y(X(d),8*d.length)));return r.toLowerCase()};function M(d){for(var _,m="0123456789ABCDEF",f="",r=0;r<d.length;r++)_=d.charCodeAt(r),f+=m.charAt(_>>>4&15)+m.charAt(15&_);return f}function X(d){for(var _=Array(d.length>>2),m=0;m<_.length;m++)_[m]=0;for(m=0;m<8*d.length;m+=8)_[m>>5]|=(255&d.charCodeAt(m/8))<<m%32;return _}function V(d){for(var _="",m=0;m<32*d.length;m+=8)_+=String.fromCharCode(d[m>>5]>>>m%32&255);return _}function Y(d,_){d[_>>5]|=128<<_%32,d[14+(_+64>>>9<<4)]=_;for(var m=1732584193,f=-271733879,r=-1732584194,i=271733878,n=0;n<d.length;n+=16){var h=m,t=f,g=r,e=i;f=md5_ii(f=md5_ii(f=md5_ii(f=md5_ii(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_ff(f=md5_ff(f=md5_ff(f=md5_ff(f,r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+0],7,-680876936),f,r,d[n+1],12,-389564586),m,f,d[n+2],17,606105819),i,m,d[n+3],22,-1044525330),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+4],7,-176418897),f,r,d[n+5],12,1200080426),m,f,d[n+6],17,-1473231341),i,m,d[n+7],22,-45705983),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+8],7,1770035416),f,r,d[n+9],12,-1958414417),m,f,d[n+10],17,-42063),i,m,d[n+11],22,-1990404162),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+12],7,1804603682),f,r,d[n+13],12,-40341101),m,f,d[n+14],17,-1502002290),i,m,d[n+15],22,1236535329),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+1],5,-165796510),f,r,d[n+6],9,-1069501632),m,f,d[n+11],14,643717713),i,m,d[n+0],20,-373897302),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+5],5,-701558691),f,r,d[n+10],9,38016083),m,f,d[n+15],14,-660478335),i,m,d[n+4],20,-405537848),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+9],5,568446438),f,r,d[n+14],9,-1019803690),m,f,d[n+3],14,-187363961),i,m,d[n+8],20,1163531501),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+13],5,-1444681467),f,r,d[n+2],9,-51403784),m,f,d[n+7],14,1735328473),i,m,d[n+12],20,-1926607734),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+5],4,-378558),f,r,d[n+8],11,-2022574463),m,f,d[n+11],16,1839030562),i,m,d[n+14],23,-35309556),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+1],4,-1530992060),f,r,d[n+4],11,1272893353),m,f,d[n+7],16,-155497632),i,m,d[n+10],23,-1094730640),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+13],4,681279174),f,r,d[n+0],11,-358537222),m,f,d[n+3],16,-722521979),i,m,d[n+6],23,76029189),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+9],4,-640364487),f,r,d[n+12],11,-421815835),m,f,d[n+15],16,530742520),i,m,d[n+2],23,-995338651),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+0],6,-198630844),f,r,d[n+7],10,1126891415),m,f,d[n+14],15,-1416354905),i,m,d[n+5],21,-57434055),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+12],6,1700485571),f,r,d[n+3],10,-1894986606),m,f,d[n+10],15,-1051523),i,m,d[n+1],21,-2054922799),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+8],6,1873313359),f,r,d[n+15],10,-30611744),m,f,d[n+6],15,-1560198380),i,m,d[n+13],21,1309151649),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+4],6,-145523070),f,r,d[n+11],10,-1120210379),m,f,d[n+2],15,718787259),i,m,d[n+9],21,-343485551),m=safe_add(m,h),f=safe_add(f,t),r=safe_add(r,g),i=safe_add(i,e)}return Array(m,f,r,i)}function md5_cmn(d,_,m,f,r,i){return safe_add(bit_rol(safe_add(safe_add(_,d),safe_add(f,i)),r),m)}function md5_ff(d,_,m,f,r,i,n){return md5_cmn(_&m|~_&f,d,_,r,i,n)}function md5_gg(d,_,m,f,r,i,n){return md5_cmn(_&f|m&~f,d,_,r,i,n)}function md5_hh(d,_,m,f,r,i,n){return md5_cmn(_^m^f,d,_,r,i,n)}function md5_ii(d,_,m,f,r,i,n){return md5_cmn(m^(_|~f),d,_,r,i,n)}function safe_add(d,_){var m=(65535&d)+(65535&_);return(d>>16)+(_>>16)+(m>>16)<<16|65535&m}function bit_rol(d,_){return d<<_|d>>>32-_}


		
		var language = "pl";
		var answers = ""
		var invalid = 0;
		var questionNr = 0;
		var estereggMode = false;

		function handleCoursor() {
			var ms300 = Math.floor(Date.now()/300);
			ctx.fillStyle = (ms300%2==0 && cursorVisible) ? curColor : "black";
			ctx.fillRect(curX*charWidth, curY*charHeight, charWidth, charHeight);
		}
		
		function startCoursor() {
		  handleCoursor();
		  coursorInterval = setInterval(handleCoursor, 300);
		}
		
		function stopCoursor() {
		  handleCoursor();
		  clearInterval(coursorInterval);
		}
		
		startCoursor();
		
		function checkVertical() {
		  if (curY*charHeight >= h-1) {
			ctx.drawImage(canvas, 0, -charHeight);
			ctx.fillStyle = "black";
			ctx.fillRect(0, h-charHeight, w, charHeight);
			curY--;
		  }
		}
		
		function advanceCoursor() {
		  curX++;
		  if (curX*charWidth >= w-1) {
		    curX = 0;
			curY++;
			checkVertical();
		  }			
		}
		
		function printChar(c) {
		  stopCoursor();
		  ctx.fillStyle = "black";
		  ctx.fillRect(curX*charWidth, curY*charHeight, charWidth, charHeight);		  
		  ctx.fillStyle = curColor;
          ctx.fillText(c,curX*charWidth,curY*charHeight);
		  advanceCoursor();
		  startCoursor();
		}
		
		function moveTo(x, y) {
		  stopCoursor();
		  ctx.fillStyle = "black";
		  ctx.fillRect(curX*charWidth, curY*charHeight, charWidth, charHeight);	  
		  curX = x;
		  curY = y;
		  checkVertical();
		  startCoursor();
		}
		
		function newLine() {
		    moveTo(0, curY+1);
		}
		
		function setColor(color) {
		    curColor = color;
		}
		
		function coursorVisible(v) {
		    cursorVisible = v;
		}
		
		function printText(text){
          for(var i=0; i<text.length; i++) {
		      printChar(text[i]);
		  }
		}
		
		function printTextSlow(text, callback, ms) {
		    var i = 0;
			setTimeout(function(){
			    if (text.length==0) {
				    callback()
                } else {
				    printChar(text[0]);
					printTextSlow(text.substring(1), callback, ms);
				}
	        }, ms??20);
		}
		
		function handleKey(key) {
		    if (readMode) {
			    if (key.length == 1) {
				  readString += key;
				  printChar(key);
				}
				
				if (key == "Backspace" && readString.length>0) {
				  readString = readString.substring(0, readString.length-1);
				  var nx = curX-1;
				  var ny = curY;
				  if (nx<0) {
				      nx = w/charWidth;
					  ny--;
				  }
				  moveTo(nx, ny);
				  printChar(" ");
				  moveTo(nx, ny);
				}				
				
				if (key == "Enter") {
				  readMode = false;
				  newLine();
				  setColor("yellow");
				  readCallback(readString);
				}
			} else if (estereggMode) {
			    clearTimeout(easterEggTimeout);
			    estereggMode = false;
				setTimeout(_=> {
				  newLine();
				  runPrompt();
				}, 200);
		    }
		}
		
		document.onkeydown = function(evt) {
		    if (evt.target.id != "mobile") {
			    handleKey(evt.key);
			}
		};	
		
		mobile.addEventListener('input', function(evt) {
		  
		  if( evt.inputType == "insertText"){
			for(var i=0; i<evt.data.length; i++) {
			  handleKey(evt.data[i]);
			}
		  }
		});
		
		mobile.addEventListener('keypress', function(e){
            if(e.keyCode === 13) { 
			  mobileInput.value = '';
			  handleKey("Enter");
			}
        });

        function readText(callback) {
		    setColor("lightgreen");
		    readMode = true;
			readCallback = callback;
			readString = "";
        }	

        function question(text, callback) {
		    setColor("yellow");
			printTextSlow(text, function() {
			    readText(function(answer) {
				    callback(answer);
				})
			});		
        }	

        function prompt(text, callback) {
		    setColor("lightgreen");
			printText(text) ;	
			readText(function(input) {
				callback(input);
			});		
        }			
		
		function easterEggDrop(x, y) {
		    if (estereggMode) {
				var maxy = h / charHeight;
				var maxx =w / charWidth	
				if (y < maxy-1) {
					var characters = "!@#$%^&*()+[]<>";
					var r = Math.floor(Math.random() * 150);
					var c = characters[Math.floor(Math.random() * characters.length) % characters.length];
					moveTo(x,y);
					setColor("lightgreen");
					printChar(c);
					setTimeout(_=>{
						moveTo(x,y);
						var b = 0;
						if (x >=(maxx/2)-30 && x < (maxx/2)+30 && y<30) {
							var n = gc[y];
							var mask = 1 << (30-((x-((maxx/2)-30))/2));
							b = n & mask;
						}
						
						setColor(b ? "lime" : "green");
						printChar(c);
						easterEggDrop(x, y+1);
					}, 75+r);	
				}
			}
		}
		
		function startEesterEgg() {
		    estereggMode = true;
		    coursorVisible(false);
			var maxx = w / charWidth;	
			var x = Math.floor(Math.random() * maxx) % maxx;
			easterEggDrop(x, 0);
			var r = Math.floor(Math.random() * 150);
			easterEggTimeout = setTimeout(_=>{
				startEesterEgg();
			}, 80+r);		
		}
		
		function pbkdf2(text, callback) {
		     var passphrase = new TextEncoder().encode(text);
			 window.crypto.subtle.importKey("raw", passphrase, { name: "PBKDF2" }, false, ["deriveBits"])
			.then(function(passphraseImported){
				window.crypto.subtle.deriveBits(
					{
						name: "PBKDF2",
						hash: 'SHA-512',
						salt: new TextEncoder().encode(keySalt),
						iterations: 100000
					},
					passphraseImported, 
					256 
				)  
				.then(function (bits) { 
					var keyHex = buf2hex(new Uint8Array(bits));
					callback(keyHex);
				}); 
			});
		}

		async function decrypt(keyHex, text, callback) {
			const keyBytes = fromHex(keyHex);
			const ivBytes = fromHex(text.substring(0, 32));
			const encryptedTextBytes = fromHex(text.substring(32));
			const key = await window.crypto.subtle.importKey(   
				"raw",
				keyBytes,                                         
				"AES-CTR",
				true,
				["encrypt", "decrypt"]
			);
			const decrypted = await window.crypto.subtle.decrypt(
				{
					name: "AES-CTR",
					counter: ivBytes,
					length: 64
				},
				key,
				encryptedTextBytes
			);

			var decryptedText =  new TextDecoder().decode(decrypted);
			callback(decryptedText);
		}
		
		function preprocess(text) {
		    return text.trim().replace(/ +(?= )/g,'');
		}
		
		function fancyShowSolution(callback) {
		    coursorVisible(false);
			setColor("deepskyblue");
            pbkdf2(answers, function(keyHex) {			    
				decrypt(keyHex, encryptedSolution, function(decryptedText){
					console.log(decryptedText);
                    var lines = decryptedText.split('\n');
				   	var line1 = lines[0];
					var line2 = lines[1];
					var mask1 = " ".repeat(line1.length);
					var mask2 = " ".repeat(line2.length);
					var t = 0;
					var signs = "!@#$%^&*()_+-=<>?,./:<>?;':{}[]";
					var maxt = 300;
					var lx = (w/charWidth) / 2 - line1.length / 2;
					var ly = (h/charHeight) / 2 - 1;
					var makeNoise = function() {
						setTimeout(_=>{
							var c = signs[Math.floor((Math.random() * (signs.length-1)))];
							var rx = Math.floor(Math.random() * line1.length);
							var ry = Math.floor(Math.random() * 2);
							var v = (ry == 0) ? line1[rx] : line2[rx];
							var m = (ry == 0) ? mask1[rx] : mask2[rx];
							if (((t > (maxt/2)) && ((Math.random()*maxt)  < t)) || (m == "*")) {
								c = v;
								if (ry == 0) {
  								    mask1 = mask1.substring(0, rx) + "*" + mask1.substring(rx+1);
							    } else {
								    mask2 = mask2.substring(0, rx) + "*" + mask2.substring(rx+1);
								}
							}
							moveTo(lx+rx, ly+ry);	
							printChar(c);
							t++;
							if (t<maxt) {
								makeNoise();
							} else {
							   moveTo(lx, ly);
							   printText(line1);
							   moveTo(lx, ly+1);
							   printText(line2);
							   newLine();newLine();newLine();newLine();newLine();newLine();newLine();newLine();newLine();newLine();newLine();newLine();
							   coursorVisible(true);
							   question(language == "en" ? "Hit enter to finish" : "Naciśnij enter aby wyjść", _=>{
								   callback();
							   });
							}
						},5);
					};
					makeNoise();
				});
			});
		}
		
		function finishQuiz(callback) {
			newLine();
			newLine();
			var answersMD5 = MD5(answers).toUpperCase();	
			if (answersMD5 == expectedMD5) {
				setColor("white");
				printTextSlow(language == "en" ? "Contratulations!!! All answers are correct. Decrypting final coordinates:" : "Gratulacje! Wszystkie odpowiedzi są poprawne: Odszyfrowywanie współrzędnych finału:", _=>{
					var l = (h / charHeight)-1;
					var il = setInterval(_=> {
					    l--;
						if (l == 0) {
						    clearInterval(il);
							fancyShowSolution(callback);
						} else {
						    newLine();
						}
					}, 30);
					
				});
			} else {
				setColor("red");
				printTextSlow(language == "en" ? "Unfortunatelly! At least one anser is incorrect. You have to try again." : "Niestety! Conajmniej jedna odpowiedź nie jest prawidłowa. Próbuj dalej.", _=>{
					newLine();
					newLine();
					newLine();
					question(language == "en" ? "Hit enter to restart\n" : "Naciśnij enter aby spróbować jeszcze raz", _=>{
						restart();
					});
				});
			}
		}
		
		function askNextQuestion() {
			if (questionNr < questions.length) { 
			    newLine();
				question(`${(questionNr+1)}. ${questions[questionNr][language]}: `, function(answer) {
				    newLine();
					if (answer == easterEggPwd) {
						startEesterEgg();
					} else if (answer.length == 0) {
					      printTextSlow(language == "en" ? ("Please provide non-empty answer."+(invalid==0?"":" (Focus this time) ")+"\n") : "Podaj niepustą odpowiedź."+(invalid==0?"":" (Tym raze skup się) ")+"\n", _=>{
						  invalid++;
						  askNextQuestion();
					  });
					} else if (answer.toLowerCase() == "exit") {
					  printTextSlow(language == "en" ? "Good bye!\n" : "Do widzenia!\n" , _=>{
					     newLine();
					     runPrompt();
					  });
					} else if (!(/^\d+$/.test(answer))) {
					      printTextSlow(language == "en" ? "Answer should only contain digits."+(invalid==0?"":" (Focus this time) ")+"\n" : "Odpowiedź powinna zawierać wyłącznie cyfry."+(invalid==0?"":" (Tym raze skup się) ")+"\n", _=>{
						  invalid++;
						  askNextQuestion();
					  });			  
					} else {
					      setColor("lightgray");
					      printTextSlow(`${nextMsgs[questionNr%nextMsgs.length][language]}` , _=>{
						  answers+=answer;
						  questionNr++;
						  newLine();
						  askNextQuestion();
					  }); 			 
					}
				});
			} else {
                finishQuiz(_=>{newLine();runPrompt();});
			}
		}		
		
	    function runQuiz() {
	        question("Select language / Wybierz język: pl=Polski (domyślny), en=English: ", function(lang) {
				if (lang == easterEggPwd) {
					startEesterEgg();
				} else if (lang.length==0 || lang.toLowerCase()=="pl") {
				    newLine();
					language = "pl"
					printTextSlow("Wybrano: Polski.\nOdpowiedz poprawnie na 10 pytań aby poznać współrzędne finału.\nOdpowiedzi zawsze są liczbami.\nW każdej chwili możesz opuścić program wpisując 'exit'.\nSprawdzenie poprawności odpowiedzi nastąpi dopiero na końcu.\nPowodzenia!\n", _=>{
					    newLine();
						askNextQuestion();
					}, 2);
				} else if (lang.toLowerCase()=="en") {
				    newLine();
					language = "en"
					printTextSlow("Selected: English.\nAnswer correctly 10 questions to get the final coordinates.\nAll answers consist of digits only.\nYou can always exit the program by typing 'exit'.\nThe result of this quiz will be displayd at the end.\nGood luck!\n", _=>{
					    newLine();
						askNextQuestion();
					}, 2);
				} else {
					printTextSlow("Spróbuj jeszcze raz (skupiając się) / Focus and try again.\n", _=>{
						runQuiz(callback);
					});
				}
	        });		
		}
		
		function runPrompt() {
		   var path = [];
		   for(var i=0; i<curPath.length; i++) {
		     path.push(curPath[i].name);
		   }
		   var pathStr = path.join('\\');
		   prompt(pathStr+"\>", function(command) { 
		       command = preprocess(command);
			   var lines = command.split(' ');
		       setColor("lightgreen");
			   var cmd = lines[0].toUpperCase();
			   var accessDenied = false;
			   var curDir = curPath[curPath.length-1];
			   for(var i=0; i<dosCommands.length; i++) {
			       if (cmd==dosCommands[i]) {
				     accessDenied = true;
				   }
			   }
			   if (accessDenied) {
			     printText("Access denied.");newLine();
			   } else if (cmd == "HELP" || cmd == "POMOC" || cmd == "POMOCY" || cmd == "?") {
			       printText("    Try DIR or CD to begin"); newLine();
				   printText("    If you are helpless google 'msdos commands'"); newLine();
				   printText("    Jeśli nie masz pojęcia co się dzieje - wygugluj 'komendy dosa'"); newLine();
			   } else if (cmd == "CD..") {
				 if (curPath.length > 1) {
					 curPath.pop();
				 } 
			   } else if (cmd == "CD") {
			     if (lines.length == 1) {
				   printText("Missing argument to cd.");newLine(); 
				 } else {
				   var cd = lines[1].toUpperCase();
				   if (cd == ".") {
				   } else if (cd == "..") {
				     if (curPath.length > 1) {
					     curPath.pop();
					 } 
				   } else {
					   var newDir = null;
					   for(var i=0; i<curDir.content.length; i++) {
						 if (curDir.content[i].name == cd) {
						   newDir = curDir.content[i];
						 }
					   }
					   
					   if (newDir == null) {
						 printText("No such directory.");newLine();
					   } else if (!newDir.dir) {
						 printText(newDir.name+ " is not directory.");newLine(); 
					   } else if (!newDir.access) {
						 printText("Access denied.");newLine(); 
					   } else {
						 curPath.push(newDir);
					   }
				   }
				 }
			   } else if (cmd == "DIR" || cmd == "LS") {
				 printText("Volume in drive C is OS."); newLine();
				 printText("Volume Serial Number is xxxx-xxxx"); newLine();
				 printText("Directory of "+pathStr); newLine(); newLine();
				 var dirCount = 0;
			     for(var i=0; i<curDir.content.length; i++) {
				   printText("    "+curDir.content[i].name+(" ".repeat(16-curDir.content[i].name.length))+(curDir.content[i].dir ? "<DIR>" : "     ")+"    2024-09-10 06:33" );
				   newLine();
				   if (curDir.content[i].dir) dirCount++;
				 }
				 newLine();
				 printText((curDir.content.length-dirCount)+" File(s), "+dirCount+" Directories");
				 newLine();
				 newLine();
			   } else if ((cmd == "QUIZ.EXE" || cmd == "QUIZ") && curDir.name=="QUIZ") {
			       runQuiz();
				   return;
			   } else if (command.length==0) {
			     //nothing
			   } else {
			     printText("I don't know how to "+cmd.toLowerCase()+".");newLine(); 
			   }

		       runPrompt();
		   });
		}
		
		function begin() {
			moveTo(0, 0)
			ctx.fillStyle = "black";
			ctx.fillRect(0, 0, w, h);
			coursorVisible(true);
			language = "pl";
			answers = ""
			invalid = 0;
			questionNr = 0;
			estereggMode = false;
			setColor("lightgreen");
			printText("MSDOS 6.22 (c) Microsoft Corp. 1988");newLine(); 
			printText("Build modified by PanJanek123 ;)");newLine();newLine(); 
			runPrompt();			
    	}
		
        begin();


	</script>
  </body>
</html>